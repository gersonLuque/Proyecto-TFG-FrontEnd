<div class="container mt-4">
  <div class="card">
    <div class="card-body">
      <h1 class="mb-4">Editar Tarea</h1>

      <form>
        <!--        datos de las tareas-->
        <app-task-details [formData]="editTaskForm"
                          [title]="task?.title"
                          [description]="task?.description"
                          [visible]="task?.visible"/>

        @if (task?.fileTasks.length > 0 && !isFilesReset) {
          <p-panel >
            <!-- Contenedor principal con espacio para el botón superior -->
            <div class="mb-3 d-flex justify-content-between align-items-center">
              <!-- Botón nuevo en la esquina superior derecha -->
              <h5 class="">Recursos</h5>
              <button (click)="isFilesReset = true" class="btn rounded-pill px-3 d-flex align-items-center gap-2 shadow-sm recarga text-white">
                <i class="bi bi-arrow-clockwise"></i>
                <span>Limpiar y volver a cargar</span>
              </button>
            </div>

            <!-- Lista de archivos -->
            <div class="col-auto">
              <div class="d-flex flex-column gap-3">
                @for (file of task?.fileTasks; track file.fileId) {
                  <!-- Archivo -->
                  <div (click)="downloadFile(file?.prefix,file?.fileName)"
                       class="card border-0 shadow-sm hover-card cursor-pointer">

                    <div class="card-body d-flex justify-content-between py-3">
                      <div class="d-flex align-items-center">
                        <img [src]="'assets/icons/pdf.svg'" class="img-fluid me-2" style="width: 24px" alt="PDF">
                        <span class="fw-medium text-truncate">{{ file.fileName }}</span>
                      </div>
                      <div class="d-flex gap-2 ms-4">
<!--                        todo es probable que este boton se quite-->
                        <button (click)="downloadFile(file?.prefix,file?.fileName)"
                                class=" action-btn download-btn btn btn-link  text-secondary p-0"
                                title="Descargar archivo">
                          <i class="bi bi-download"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                  <!-- Fin archivo -->
                }
              </div>
            </div>
          </p-panel>
        } @else {
          <!--        carga de ficheros-->
          <app-app-upload-files (uploadedFilesChange)="handleUploadedFiles($event)"></app-app-upload-files>
        }

        <!--        Botón de envío-->
        <button type="submit" class="btn btn-dark w-100 py-2 mt-4" (click)="sendData()">
          Actualizar tarea
          @if (isLoading) {
            <p-progress-spinner ariaLabel="loading" [style]="{ width: '30px', height: '25px' }"/>
          }
        </button>
      </form>
    </div>
  </div>
</div>
